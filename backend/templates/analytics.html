{% extends "base.html" %}
{% block content %}

<div class="container mt-4">
  <h3 class="mb-4">ðŸ“Š Task Analytics</h3>

  <!-- SUMMARY CARDS -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <h6>Total Tasks</h6>
          <h3>{{ total_tasks }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <h6>Completed</h6>
          <h3>{{ completed_tasks }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <h6>Pending</h6>
          <h3>{{ pending_tasks }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <h6>Productivity</h6>
          <h3>{{ productivity_score }}%</h3>
          <span class="badge 
            {% if productivity_score < 40 %}bg-danger
            {% elif productivity_score < 70 %}bg-warning
            {% else %}bg-success{% endif %}">
            {{ productivity_badge }}
          </span>
        </div>
      </div>
    </div>

    <div class="col-md-3">
  <div class="card text-center shadow-sm">
    <div class="card-body">
      <h6>ðŸ”¥ Streak</h6>
      <h3>{{ streak }} days</h3>
    </div>
  </div>
</div>

  </div>

  <!-- CHARTS -->
  <div class="row">
    <div class="col-md-6">
      <canvas id="statusChart"></canvas>
    </div>

    <div class="col-md-6">
      <canvas id="priorityChart"></canvas>
    </div>
  </div>

  <div class="row mt-4">
    <div class="col-md-12">
      <canvas id="weeklyChart"></canvas>
    </div>
  </div>

</div>

<script>
new Chart(document.getElementById("statusChart"), {
  type: "doughnut",
  data: {
    labels: ["Completed", "Pending"],
    datasets: [{
      data: [{{ completed_tasks }}, {{ pending_tasks }}],
      backgroundColor: ["#198754", "#ffc107"]
    }]
  }
});

new Chart(document.getElementById("priorityChart"), {
  type: "bar",
  data: {
    labels: {{ priorities|tojson }},
    datasets: [{
      label: "Tasks",
      data: {{ priority_counts|tojson }},
      backgroundColor: "#0d6efd"
    }]
  }
});

new Chart(document.getElementById("weeklyChart"), {
  type: "line",
  data: {
    labels: {{ week_dates|tojson }},
    datasets: [{
      label: "Tasks",
      data: {{ week_counts|tojson }},
      borderColor: "#6610f2",
      fill: false
    }]
  }
});
</script>

{% endblock %}
